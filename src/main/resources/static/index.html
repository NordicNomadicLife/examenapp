<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>BudgetApp</title>
</head>
<body>
<h1>BudgetApp</h1>

<form id="form">
    <input name="amount" placeholder="Belopp" type="number" step="0.01" required />
    <select name="type">
        <option value="INCOME">Inkomst</option>
        <option value="EXPENSE">Utgift</option>
    </select>
    <input name="category" placeholder="Kategori" required />
    <button type="submit">Spara</button>
</form>

<h2>Ã–versikt</h2>
<div id="summary"></div>

<script>
    async function loadSummary() {
        const res = await fetch('/api/summary');
        const data = await res.json();
        document.getElementById('summary').innerHTML = `
        Inkomst: ${data.totalIncome} kr<br>
        Utgifter: ${data.totalExpenses} kr<br>
        Sparande: ${data.savings} kr
      `;
    }

    document.getElementById('form').onsubmit = async e => {
        e.preventDefault();
        const form = e.target;
        const data = {
            amount: parseFloat(form.amount.value),
            type: form.type.value,
            category: { name: form.category.value },
            date: new Date().toISOString()
        };

        await fetch('/api/transaction', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });

        form.reset();
        loadSummary();
    };

    loadSummary();
</script>
</body>
</html>
